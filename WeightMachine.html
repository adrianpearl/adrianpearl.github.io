<!DOCTYPE html>
<html>
<head>
<title>Adrian Pearl's Portfolio Website - A Smart Weight Machine</title>
<link rel="stylesheet" type="text/css" href="css/styles3.css">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="icon" href="img/favicon.png">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js">
</script>
<script src="index.js"></script>

</head>
<body>

	<header class="nav-down">
	<div class="title">
		<h1>Adrian Pearl</h1>
	</div>
	<div class="nav" id="nav">
		<ul>
    		<li><a href="index.html">Intro</a></li>
    		<li><a href="Main.html">Portfolio</a></li>
    	</ul>
	</div>
	</header>
	
	<div class="spacer"></div>
	
	<div class="title-cell">
	<img id="titleimage" src="img/koala.jpg">
	<span class="pageTitle"><pageTitle>A Smart Weight Machine</pageTitle></span>
	</div>
	
	<div id="body">

		<span>
		
			Over the past several months, I've worked on creating a weight machine that uses a couple of sensors to track users' workouts and bluetooth to send this data to their phones. The idea was inspired by fitness wearables like Fitbit. These do a great job of describing your general activity level - how many steps you've taken, how many minutes you were "active" each day, etc. But people who work out in a gym need more information to track their progress, like which exact exercise they've done, the number of repetitions, and the weight they used. So you could say my goal was to create an experience like a "Fitbit for gyms", and turn ordinary gyms into <em>smart gyms</em>.
			
			</br></br>
			
			I've prototyped both the physical device and the full user experience on an iOS app. The short video below explains the idea, and you can read on to learn about my process.</br></br>
			
			<iframe id="video" height="315" src="https://www.youtube.com/embed/smj3c05TOEY" frameborder="0" allowfullscreen></iframe>
			
			<div id="image" style="margin-bottom:0">
			<a href="#problem" class="tablecontents">The Problem</a>
			<a href="#prior" class="tablecontents">Prior Art</a>
			<a href="#criteria" class="tablecontents">Design Criteria</a>
			<a href="#focus" class="tablecontents">Narrowing the Focus</a>
			<a href="#plates" class="tablecontents">Counting Plates</a>
			<a href="#firmware" class="tablecontents">Firmware and Software</a>
			</div>
			
			<a name="problem"></a></br>
			<sectionHead>The Problem</sectionHead>
			
			One day last year, I was lifting weights in the gym when I realized I couldn't tell if I was lifting more or less weight than the last time I had gone. And that was less than a week before - go back a month and I had no clue.
					
			</br></br>
			
			I should start writing stuff down, I thought. Or maybe use one of those apps where you enter all the exercises you did and you can look at them later. I tried using an app called JEFIT for a couple days, but it quickly became too cumbersome to interrupt my workout every couple minutes to type in some numbers.
			
			<img id="image" src="bla" alt="Is this even useful?">
			
			Then the thought came to me that maybe the gym, or rather, the gym's equipment, could track your exercises for you. After talking to a few people I knew and confirming that this wasn't just a problem for me, I decided it was worth looking into.
			
			<a name="prior"></a></br>
			<sectionHead>Prior Art</sectionHead>
			
			A lot of people have approached the problem of tracking exercises in a gym, and pretty much all of them can fit into a few categories:
			
			<ol>
				<li>Stand-alone apps that no one has time for. A study last year from NYU School of Medicine found that the number one reason people delete fitness-related smartphone apps is that it takes too long to enter their data.</li>
				<li>Wearables that try to go beyond steps and track weightlifting exercises. Some are very cool, but none get the job done in full. The <a id="link" href="http://www.atlaswearables.com">Atlas wristband</a>, for example, doesn't know how much weight you're lifting, and can only identify your exercises automatically if you plan them out before your workout.</li>
				<li>Companies trying to upgrade gymsâ€™ equipment to track workouts, which was my initial thought. Some, like <a id="link" href="https://www.youtube.com/watch?v=BfnPogUokKs">Fitlinxx</a>, look like Windows 98. Others, like <a id="link" href="http://eGym.com">eGym</a>, are better but still cost tens of thousands of dollars. And besides, who wants to spend their entire workout staring at touchscreen?</li>
			</ol>
			
			<a name="criteria"></a></br>
			<sectionHead>Design Criteria</sectionHead>
			
			After researching more about the problem and talking to some gym managers and trainers, I was ready to start defining what a solution to this problem should look like:
			
			<ul>
				<li>A typical gym's equipment is worth around half a million dollars and is not easily replaceable (it is often leased), so a commercially viable product needs to retrofit existing equipment.
				<li>My core belief was that users were incredibly averse to constant interruptions lasting even a few seconds to capture data. Interruptions should happen once for each exercise and never last more than a second.</li>
				<li>Most gym tracking products require you to interact either with some wearable or with a touchscreen display. We already carry phones in our pockets that are much easier to use than either of those, so the product should only require the use of a smartphone.</li>
				<li>Finally, each new piece of outfitted equipment means one more device with one more battery. Gym staff can't be bothered with changing or charging batteries all the time, so they would need extremely low power consumption.</li>
			</ul>
			
			<a name="focus"></a>
			<sectionHead>Prototyping</sectionHead>
			<sectionHead class="sub">Narrowing the Focus</sectionHead>
			
			To begin to actually solve this problem, I distilled the job of this device down to four tasks: identify the exercise, count the reps, measure the weight, and transmit the data to the smartphone.
			
			</br></br>
			
			 For data transmission, I decided the best mechanism would be Bluetooth Low Energy because it's reliable, already built into smartphones, and used in Fitbits and a ton of other gadgets. I picked up some developer kits like <a href="https://www.adafruit.com/products/2829" id="link">this one from Adafruit</a> and within a week or two I was writing some pretty simple sketches and iOS apps to get my phone to communicate with them.
			
			</br></br>
			
			I quickly realized that the other three tasks, particularly exercise identification, were much more difficult. A few ideas popped into my head, like stationing some cameras at every piece of equipment and they could do everything. Maybe I could color code the weights to help the camera identify the weight, and use some amazing machine learning algorithms to identify exercises. I got a <a href="http://charmedlabs.com/default/pixy-cmucam5/" id="link">Pixy</a> and started tinkering with it, but I knew that implementing this idea would take a lot of time and money, and it was also kind of creepy to think about a bunch of cameras stationed all over a gym.
			
			<img id="image" src="img/pixyada.jpg" alt="Pixy">
			
			Then I realized I couldn't possibly think of a catch-all solution to track every exercise, but some types of exercise are much easier to track than others. Dumbbells are very hard, because you can use a single pair for myriad exercises in any location, but it's relatively easy to track exercises done on weight machines. Each machine is usually only used for a single exercise, so identification is trivial, and the rest boils down to counting how many plates are going up and down, and how many times. So I would start with weight machines and the rest could come later.		
			
			<a name="plates"></a></br>
			<sectionHead class="sub">Counting Plates</sectionHead>
			
			For a weight machine, it's simple to use something like an accelerometer to count the number of times the weights go up and down. The more difficult task is figuring out how many plates the user is lifting. I tried a bunch of ideas for this - strain gauges, distance sensors, and a couple others, but none of them were both reliable and precise. 
			
			<img id="image" src="img/foam.jpg">
			
			The solution I came up with was to attach a small resistive element to each weight in the stack. The device at the top transmits a signal, which is attenuated slightly by each weight it passes through. If the user is lifting four plates, those four will be touching each other, so the signal will experience four attenuations. All the device has to do, then, is measure the total attenuation to figure out how many plates are being lifted. The hardest thing about this design was ensuring that each "link" in the "chain" maintained reliable electrical contact with its neighbors whenever they were touching. Any given weight could be constantly separating from one of its neighbors and rejoining it, sometimes at high speeds. To test out ideas, I built a wooden model of a weight machine and started attaching electronics to it.
			
			<img id="image" src="img/foam2.jpg">
			
			<a name="firmware"></a></br>
			<sectionHead class="sub">Firmware and Software</sectionHead>
			
			The final tasks were to attach a device at the top with an accelerometer to count reps, a physical interface with the "chain" I had built to measure weight, and bluetooth to put it all together, <i>then</i> write an iOS app to make it work for the user. I chose the <a id="link" href="https://punchthrough.com/bean">LightBlue Bean from Punchthrough</a> as my MCU because it's an awesome little board that has an on-board accelerometer, most of the capabilities of an arduino, and works on a coin cell. It's also programmable wirelessly which was unnecessary but very cool.
			
			</br></br>
			
			In the end, most of my time was spent learning the finer points of Bluetooth on iPhones and thinking of ways to simplify the user experience. In early prototypes I made, the user would have to unlock their phone and open the app after each workout to collect data. This was an improvement, but not nearly enough, so I redesigned the app to work offscreen and allow the user to collect their data from the lock screen.
			
			</br></br>Image</br></br>

		</span>
				
	</div>
	
	<div class="bottom">
		Site designed by Adrian Pearl.
	</div>

	
		

</body>
</html>